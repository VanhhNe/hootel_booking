{%extends 'nav_bar.html'%}

{%block content%}
<!--Message -->
{%with messages = get_flashed_messages()%}
{%if messages%}
{%for msg in messages%}
<div class="msg">{{msg}}</div>
{%endfor%}
{%endif%}
{%endwith%}
<!--End message-->
<!-- profile -->
<div class="container">
    <div class="m-3">

        <!-- Breadcrumb -->
        <nav class="main-breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{{url_for('view.home')}}">Trang chủ</a></li>
                <li class="breadcrumb-item active">Thông tin cá nhân</li>
            </ol>
        </nav>
        <!-- End Breadcrumb -->

        <div class="row my-3">
            <div class="col-md-5 col-lg-4 col-xl-3 my-3">
                <div class="card shadow">
                    <div class="card-body">
                        <div class="text-center">
                            {%if img %}
                            <img src="{{url_for('view.image_file', name=img['name'], folder=img['folder'])}}" alt="User"
                                class="image-profile">
                            {%else%}
                            <img src="{{url_for('view.image_file', name='undefine.jpg', folder='user_image')}}"
                                alt="User" class="image-profile">
                            {%endif%}
                        </div>
                        <hr>
                        <div class="mt-3 text-center bold-text">
                            <h4 class="bold-text">{{ info.user_name }}</h4>
                            <p class="text-secondary"> {{ khachhang.customer_note }}</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-7 col-lg-8 col-xl-9 my-3">
                <div class="card mb-3 shadow">
                    <div class="card-body bold-text">
                        <div class="row">
                            <div class="col-sm-3">
                                <h6 class="bold-text mb-0">Họ và tên</h6>
                            </div>
                            <div class="col-sm-9 text-secondary">
                                {% if khachhang.first_name %}
                                {{ khachhang.first_name}} {{ khachhang.last_name}}
                                {% else %}
                                {{ session.username }}
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="card shadow">
                        <div class="card-body">
                            <h5 class="d-flex align-items-center mb-3">Lịch sử giao hoạt động</h5>

                            {%if lichsu%}
                            <table id="customers">
                                <thead>
                                    <tr>
                                        <th>Tên phòng</td>
                                        <th>Thời gian bắt đầu</td>
                                        <th>Thời gian kết thúc</td>
                                        <th>Trạng thái</td>
                                        <th>Hành động</td>
                                    </tr>
                                </thead>
                                <tbody>
                                    {%for row in lichsu%}
                                    <tr>
                                        <td>{{row.room_name}}</td>
                                        <td>{{row.time_start.strftime("%d/%m/%Y")}}</td>
                                        <td>{{row.time_end.strftime("%d/%m/%Y")}}</td>
                                        <td>{{row.status}}</td>
                                        <td><a href="#">Xem chi tiết</a></td>
                                    </tr>
                                    {%endfor%}
                                </tbody>
                            </table>
                            {%endif%}
                        </div>
                    </div>
                </div>


            </div>
            <div class="col-12">
                <div class="card shadow">
                    <div class="card-body">
                        <h5 class="d-flex align-items-center mb-3">Lịch sử giao hoạt động</h5>

                        {%if lichsu%}
                        <table>
                            <thead>
                                <tr>
                                    <td class="dataTable">Tên phòng</td>
                                    <td>Thời gian bắt đầu</td>
                                    <td>Thời gian kết thúc</td>
                                    <td>Trạng thái</td>
                                </tr>
                            </thead>
                            <tbody>
                                {%for row in lichsu%}
                                <tr>
                                    <td>{{row.room_name}}</td>
                                    <td>{{row.time_start}}</td>
                                    <td>{{row.time_end}}</td>
                                    <td>{{row.status}}</td>
                                    <td><a href="#">Hủy</a></td>
                                </tr>
                                {%endfor%}
                            </tbody>
                        </table>
                        {%endif%}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
<!-- profile end -->

<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"></script>
{%endblock%}